
  <!DOCTYPE html>
  <html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="vendor/jquery.mobile-1.4.5/jquery.mobile-1.4.5.min.css" />
    <script src="vendor/jquery-1.11.2.min.js"></script>
    <link rel="stylesheet" href="index.css" />
    <script src="vendor/jquery.mobile-1.4.5/jquery.mobile-1.4.5.min.js"></script>
  </head>

  <body>

    <!-- Page -->
    <div data-role="page" id="main" data-theme="b">

      <!-- Header -->
      <div data-role="header" data-position="fixed" data-tap-toggle="false">

        <a href="#popupMenu" data-rel="popup" data-transition="slideup" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-icon-left ui-btn-b">Mode</a> <!-- ui-icon-gear  -->
        <div data-role="popup" id="popupMenu" data-theme="b">
          <ul data-role="listview" data-inset="true" style="min-width:210px;">
            <li data-role="list-divider">Mode</li>
            <li><a href="#">Mode Playback</a></li>
            <li><a href="#">Mode Passthrough</a></li>
            <li><a href="#">Mode Player</a></li>
            <li><a href="#">Mode Random</a></li>
          </ul>
        </div>

        <h1 id="songname">I like Chopin</h1>
        <progress id="progressbar" style="width: 100%;" max="100"></progress>
        <a href="#" data-icon="grid" class="ui-btn-right" onclick="toggleFullScreen();">Fullscreen</a>

        <div data-role="navbar"> <!-- Buttons -->
          <ul>
            <li><a href="#" class="class_stop_button" onclick="Do('stop');">Stop</a></li>
            <li><a href="#" class="class_top_button" onclick="Do('replay');">Replay</a></li>
            <li><a href="#" class="class_top_button" onclick="Do('shuffle');">Shuffle</a></li>
          </ul>
        </div><!-- /navbar -->

      </div><!-- /Header -->

      <!-- Content -->
      <div role="main" class="ui-content">

        <div data-role="collapsible" data-collapsed="true">
            <h4>Abba</h4>
            <ul data-role="listview">
                <li><a href="#">Thank you for the music</a></li>
                <li><a href="#">The winner takes it all</a></li>
            </ul>
        </div>

        <div data-role="collapsible" data-collapsed="true">
            <h4>BACH JOHANN SEBASTIAN</h4>
            <ul data-role="listview">
                <li><a href="#">Praeludium und Fuge 2 in c Moll BWV 847</a></li>
                <li><a href="#">Prelude and Fugue in C major BWV 846</a></li>
                <li><a href="#">Pr√§ludium und Fuge in D Dur, BWV 850</a></li>
            </ul>
        </div>

      </div><!-- /Content -->

      <!-- Footer-->
      <div data-role="footer" data-position="fixed" data-tap-toggle="false">
        <form class="ui-grid-a">
          <div class="ui-block-a">

            <a href="#popupMenu" data-rel="popup" data-transition="slideup" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-icon-gear ui-btn-icon-left ui-btn-b">Mode</a>
            <div data-role="popup" id="popupMenu" data-theme="b">
              <ul data-role="listview" data-inset="true" style="min-width:210px;">
                <li data-role="list-divider">Mode</li>
                <li><a href="#">Mode Playback</a></li>
                <li><a href="#">Mode Passthrough</a></li>
                <li><a href="#">Mode Player</a></li>
                <li><a href="#">Mode Random</a></li>
              </ul>
            </div>

          </div>
          <div class="ui-block-b">
            <input type="button" value="QrCode">
          </div>
        </form>
        </div><!-- /Footer-->


    </div> <!-- /Page -->

    <script>

    /* Click on button */
    function Do(order) {
      /* ShowLoader();
      fetch('?do='+order); */
      console.log("Do="+order);
      fetch('http://127.0.0.1:8888/?do='+order);
      getStats();
      $(".ui-btn-active").removeClass('ui-btn-active');
      /* $(obj).removeClass('ui-btn-active'); */
    }

    /* Click on FullScreen */
    function toggleFullScreen() {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
        localStorage.setItem('fullscreen',true);
      } else if (document.exitFullscreen) {
        document.exitFullscreen();
        localStorage.setItem('fullscreen',false);
      }
    }

    /* API */
    async function getStats() {

      try {
        /* const response = await fetch('status.json'); */
        const response = await fetch('http://127.0.0.1:8888/status.json');
        const data = await response.json();

        console.log("GET="+data.nameclean);

      /* Song Name */
        $('#songname').text(data.nameclean);
        document.title = data.nameclean;

      /* Progress bar */
      $('#progressbar').val(data.played);

      } catch (error) {
        console.error('---> NETWORK ERROR : ', error);
      }

      $(".ui-btn-active").removeClass('ui-btn-active');
    }

    /* Main script */
    getStats();
    setInterval(getStats, 2000);

    </script>

  </body>
  </html>
